---
description: 非常勤講師勤務時間集計アプリのExcel出力・データ処理ロジック
---

# ⚠️ 重要な注意点

**一度決めたデザインや書式は、ユーザーからの明示的な指示がない限り絶対に変更しないこと。**

特に以下の項目は厳守すること：
- Excel出力のフォントサイズ、列幅、セル色
- ヘッダーの改行位置（特能列の `\n`）
- 罫線スタイル（外枠:Medium、内側縦:Thin、内側横:Dotted）
- 色分けルール（講習会:青、振替:緑、特能:黄色背景、手動修正:赤）

## 主要ファイル

- `src/utils/exporter.ts` - Excel出力ロジック
- `src/utils/transformer.ts` - データ変換ロジック
- `src/components/FixDataModal.tsx` - データ修正モーダル

## Excel出力仕様

### フォントサイズ
- メインヘッダー: **10** (Meiryo UI)
- ミニテーブル: 10
- データセル: 10
- タイトル: 14 (Bold)

### 列幅
- K,L,M列 (集団/事務/英会話): 10 (改行防止)
- N列 (教科): 25

### 色分け
- 手動修正行: 赤文字 `#FF0000`
- 講習会: 青文字
- 振替: 緑文字
- 特能: 黄色背景 (生徒名のみ)

### 関数
- ミニテーブル: `=SUM(H11:H1000)` 等
- 集計シート: `='講師名'!H4` 等で個別シート参照

## 手動修正ロジック

1. `_isManuallyFixed = true` を設定するタイミング:
   - 時間修正時 (`handleTimeChange`)
   - 判定変更時 (`handleTypeForce`)

2. 時間再計算:
   - `_isManuallyFixed` が true の場合、start/end から duration を再計算
